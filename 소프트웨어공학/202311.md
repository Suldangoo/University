# ■ 9주차 (11월 9일)

# 깃 활용방법 2

### 지난 시간 리뷰

- 로컬 작업공간 : 실제로 작업하는 공간
- 스테이징 영역 : 변경 사항을 스테이징 영역에 추가
- 로컬 리포지토리(.git) : 로컬에 존재하는 리포지토리로 커밋
- 원격 리포지토리(Github) : 로컬의 변경사항을 원격으로 푸쉬

### git commit 취소하기

- git reset
- git reset -hard

## Branch

- git branch
    - 기능 개발, 버그 수정, 실험적 변경 사항 등 독립적인 개발 환경 분리
    - 새로운 브랜지를 생성하거나, 목록을 보여주거나, 삭제할 수 있다.
- 새로운 변경사항을 메인에 다 커밋하면 문제점이 있음
    1. 미완성된 코드가 원격 리포지토리로 올라가는 상황
    2. 의미 단위로 커밋하지 않아 이후 리뷰등에 문제 발생
    - 해결 방안 : branch 사용 : 다른 사용자와의 변경사항이 섞이지 않음.
- git에서 branch의 실체 : 특정 commit을 가리키는 단순한 포인터 역할
- HEAD는 현재 내가 위치한 브랜치를 가리키는 것

### 명령어

- git branch 브랜치명 : 브랜치명의 브랜치 생성
- git branch -l : 현재 브랜치 리스트 출력
- git checkout 브랜치명 : 브랜치 이동
- git checkout -b 생성할 브랜치명, 생성할 브랜치가 가리킬 커밋 : 생성하며 이동

## git merge

- 두 브랜치에서 작업한 내용을 하나로 병합하는 것
- 병합이란 서로 다른 브랜치의 changeset들을 결합하는 새로운 commit을 만드는 것을 의미
- git merge featureA (대상 브랜치 이름)
    - 현재 작업중인 브랜치에 대상이 되는 브랜치의 내용을 머지하는 것
- git branch -D 브랜치 이름 : 브랜치 삭제

### Three-way Merges

- 메인 브랜치와 두 변경사항의 브랜치가 존재할 때
- A브랜치의 내용을 메인에 머지시키면, A브랜치의 커밋이 가장 최근 커밋이 됨
- 총 3개의 포인트가 관여하며, Source의 체인지셋들과 base에서의 Target까지의 체인지셋을 비교하며 병합
- B브랜치의 내용을 메인에 머지하며 새로 생긴 커밋을 가장 최근 커밋과 모두 포함하는 새로운 커밋이 생성

### git log

- git log - -oneline - -graph : 로그를 그래프 형태로 출력
- git log - -oneline - -all : 모든 브랜치의 내용을 출력
- git log - -oneline - -all - -graph : 모든 브랜치 내용을 출력하며 분기를 그래프로 표현

## conflict(컨플릭트, 충돌)

- 머지를 수행하는 과정에서 분기가 발생한 베이스를 기준으로, 특정 파일에 대해 동시에 체인지셋이 있어 깃에 의해 자동으로 머지가 되지 않음.
- 이 부분에선 어떤 변경사항을 선택할지 직접 수작업으로 고쳐야 함.
- 소스코드 파일 내의 line 단위로 비교, 서로 다른 line에서 발생한 변경사항은 컨플릭트가 발생하지 않음
- Fast-Forward에선 이미 전 분기가 포함되어있어 컨플릭트가 발생할 수 없음
- Three-way Merges에선 체인지셋이 각 브랜치에 있어 컨플릭트 발생 가능성 존재
- 두 변경사항을 직접 비교하여 editor를 이용해 수정하고, 원하는 변경사항을 직접 선택해 변경

## rebase와 squash

- 로컬에서 여러 커밋을 하나로 합치고 싶을 때 git merge를 수행하는 명령어
- Rebase and Merge
    - 브랜치에서 작업하는 동안 생성 시점 이후로 메인 브랜치에서의 변경사항이 많고, 버그 수정 등 중요한 내용이 메인 브랜치에 반영되었을 때 사용하는 머지
    - 메인 브랜치에 새롭게 변경된 내용을 해당 브랜치로 반영 후, 해당 브랜치 작업이 완료되었을 때 다시 메인 브랜치로 머지할 수 있음
    1. A브랜치에서 기능 개발 도중 기존 소스코드의 버그로 개발 진행이 중단
    2. 해당 버그 수정 사항이 메인 브랜치에 반영
    3. 그 내용을 A브랜치의 기능 개발 전 커밋 사이에 끼워넣기
        1. git rebase 타겟 브랜치 명령어
- Squash and Merge
    - 기능 개발을 위해 생성한 브랜치에서 작업 중, 중간중간 그 때까지의 진행사항을 임시저장
    - 이 떈 커밋메시지 신경쓰지 않고 입력
    - 이런 커밋들은 그 자체로 의미 없고, 메인 브랜치에는 개별 커밋으로 반영되면 안됨
    - 머지를 수행할 때 이러한 임시 커밋을 제거하고 의미단위 커밋을 위해 모든 커밋을 하나의 커밋으로 변환, 통합하여 반영
    1. 별도 생성한 브랜치에서 발생한 커밋을 하나로 묶어 별도의 커밋 생성. 합쳐지기 이전 커밋들은 로그에서 확인되지 않음.
    2. 메인 브랜치 이동 후 git merge - -squash <소스 브랜치>
    3. 이러면 joint 커밋이 아닌 완전 별도의 커밋이 생성됨