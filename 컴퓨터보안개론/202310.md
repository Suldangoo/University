# ■ 5주차 (10월 10일)

# 웹과 HTTP

### 웹의 이해

- 팀 버너스 리가 연구 목적으로 1989년 CERN에서 시작
- 연구 당시엔 웹을 ‘하이퍼 텍스트 프로젝트’ 라고 부름
- 현재 웹 문서로 가장 많이 쓰이는 하이퍼 텍스트 스크립트 언어는 HTML
- 웹은 수많은 보안 취약점이 내재되어 있어 해킹에 취약한 집중적인 공격 대상

### HTTP 프로토콜

- 여러 프로토콜 중 가장 많이 쓰이는 프로토콜은 HTTP
- HTTP 0.9버전 (초창기) 연결 과정
    1. 서버가 준비 상태
    2. 클라이언트는 읽고자 하는 문서를 서버에 요청
    3. 서버는 웹 문서 중에서 요청받은 것을 클라이언트에 전송
    4. 전송 성공 (200) 반환 시 연결 해제
    - 이 방법은 요청할 때마다 매번 연결을 해야하므로 비효율적
- HTTP Request
    - GET 방식 : 가장 일반적인 형태, 요청 데이터의 인수를 URL로 전송
        - 데이터가 주소 입력란에 표시되므로 최소한의 보안도 유지하지 않는 취약한 방식
    - POST 방식 : URL이 아닌, HTTP 헤더에 데이터를 전송
        - 다른 사용자가 링크로 해당 페이지를 볼 수 없음
        - 게시판의 경우, 목록이나 글 보기 화면은 접근 자유도를 위해 GET을 쓰지만, 게시글 저장 수정 삭제 등 대용량 데이터를 전송할 땐 POST 방식을 사용
- HTTP Response
    - 클라이언트의 HTTP Request에 대한 응답 패킷
    - 주요 실행결과 코드
        - 100번대 : 정보 전송
        - 200번대 : 성공
        - 300번대 : 리다이렉션
        - 400번대 : 클라이언트 측 에러
        - 500번대 : 서버 측 에러
- HTTP 3.0
    - 기존 HTTP2에선 TLS 프로토콜에서 3-핸드셰이킹으로 많은 시간이 소요됨
    - HTTP3에선 전송 / 응용 세션의 QUIC 프로토콜이 TLS 1.3을 포함하고 있어 1번만 통신으로 충분해 시간이 3배는 짧아짐

### 프론트엔드

- HTML
    - 클라이언트, 웹 브라우저에서 실행되는 프로그램 영역
    - HTML은 보안적으로 강한 이유가, 정적이어서 애초에 침입해도 뭐 아무것도 없음
    - 서버에 HTML문서를 저장하고 있다가 클라이언트가 특정 HTML 페이지를 요청하면 해당 문서를 전송
- CSS
    - 동적인 웹 서비스. 자바스크립트 등이 사용됨
    - HTML과 마찬가지로 웹 브라우저에 의해 해석 및 적용
    - 서버가 아닌 웹 브라우저에서 해석되어 화면에 적용되므로 서버의 부담을 줄이고 기능 수행

### 백엔드

- 웹 서비스를 제공하는 데 필요한 REST API를 제공하는 영역
- JAVA, 파이썬 등이 사용
- 클라이언트에 구현된 기능에 필요한 인자 전달받은 후 함수처럼 결과를 전달함
- 함수는 URL에 따라 구분되며, 그 결과는 JSON 형태로 클라이언트에 전달

# 웹 해킹

## 스캐너, 프록시

- 웹 취약점 스캐너를 통한 정보 수집
    - 스캐너를 통해 빠르게 다양한 접속 시도를 수행할 수 있음
    - 확인된 취약점은 실제 보안 문제가 있는 취약점이 아닌 경우가 많음
- 웹 프록시를 통한 취약점 분석
    - 웹의 구조를 파악하거나 취약점 점검 시, 웹 해킹할 땐 웹 프록시 툴 사용
    - 클라이언트에 설치되고, 클라이언트의 통제를 받음
    - 클라이언트가 웹 서버와 브라우저 간의 HTTP 패킷을 프록시를 통해 확인, 수정 변조 가능
    - 클라이언트 ↔ 서버 양 방향으로 가는 패킷 모두 변조 가능
    - 즉, 서버가 클라이언트로 보낸 데이터 변조로 인해 발생하는 위험 자체를 없애야 함. 서버에서 클라이언트로 전송한 값을 다시 참조하지 말아야 함.

## 구글 해킹

- 주요 검색 인자에 admin, password 검색 하면 관련 문서가 전부 떠버림
- 웹 해킹을 하며 많은 정보를 수집하려면 구글 검색엔진이 유용
    - site, filetype, link, cache, intitle, inurl…
- 검색 엔진의 검색을 피하는 방법
    - User-agent : googlebot 등으로 검색 엔진의 검색을 막을 수 있음.
    - Disallow: /admin 등의 방법으로 admin 디렉터리 접근을 방지할 수 있음.

# 웹의 취약점과 보안

- 웹의 주요 취약점
    - 국제웹보안표준기구에서 각 분야별 상위 1가지 주요 취약점 발표

### 명령 삽입 취약점

- SQL 인젝션 공격
- 클라이언트의 요청을 처리하기 위해 전송받는 인수에 특정 명령을 삽입
- 필터링하지 못하면 삽입 공격에 대한 취약점이 발생
- SQL, OS, LDAP 등 웹으로 명령을 전달하는 모든 경우에 적용 가능
    - SQL문에서 Where로 입력되는 조건문을 항상 참으로 만들기 위해 조건 값에 or이나 = 삽입
    - password 부분을 or 조건으로 바꾸어 항상 만족되므로 공격자는 사용자 인증에 성공
    - ID는 정상적으로, Password는 ‘or’’=’로, 혹은 주석문을 넣어서

### 인증 및 세션 관리 취약점

- 취약한 패스워드 설정 (admin / admin)
- 사용자 데이터를 이용한 인증
    - 정상적인 아이디와 패스워드로 로그인
    - 해당 값으로 쿠키와 같은 세션 값을 활용
    - 세션 인증 값은 그대로 사용하고, UserNo 값만 변경해 다른 계정으로 로그인한 것처럼 사용

### XSS 취약점 (Cross-Site Scripting)

- XSS : 공격자가 작성한 스크립트가 다른 사용자에게 전달되는 것
- 다른 사용자의 웹 브라우저 안에서 적절한 검증 없이 실행되기 때문에 사용자의 세션 탈취 혹은 웹 사이트 변조, 악의적인 사이트로 이동할 수 있게 됨
- 공격 구조
    - XSS 취약한 서버에 XSS 코드 저장
    - 일반 사용자가 해당 XSS코드에 접근
    - 웹 서버는 사용자 접근에 XSS 코드를 포함한 게시판의 글을 전달
    - 사용자가 XSS 코드를 실행

### 취약한 접근 제어 (Broken Access Control)

- 디렉토리 탐색을 생각할 것
- 인증된 사용자가 수행할 수 있는 것에 대해 제대로 제한을 걸어두지 않은 것을 의미
- 즉, 일반 사용자나 로그인하지 않은 사용자가 관리자 페이지 접근, 권한 기능 악용
- 우회를 막기 위해선 웹의 중요 페이지에 세션 값(쿠키) 확인 검증 로직 작성
- 디렉터리 탐색
    - 웹 브라우저에서 확인 가능한 경로의 상위를 탐색, 특정 시스템 파일을 다운로드
    - URL사이트 위에 download.jsp?filename=비밀파일.hwp를 입력해 파일 다운

### 보안 설정 오류 (Security Misconfiguration)

- 디렉터리 리스팅
    - 웹 브라우저에서 웹 서버의 특정 디렉터리를 열면 그 디렉터리 하위 파일 목록이 보임
- 백업 및 임시 파일 존재
    - 웹 사이트 개발 시 웹 서버 파일이나 임시 파일 삭제를 안해서 공격자가 내부 로직 접속
- 미흡한 주석 관리
    - 일반인도 볼 수 있는 주석에 개발 과정, 주요 로직 설명, 디렉터리 구조, 아이디 패스워드 기록
- 파일 업로드 제한 부재
    - 공격자가 웹 서버에 악의적인 파일 전송, 원격지에서 실행하면 웹 서버 장악 및 내부 침투
    - 다운로드는 자유롭게 해도 되지만 업로드는 정상적인 가입자와 동시에 필터링을 걸어둘 것
- **리버스 텔넷**
    - 공격자가 웹 해킹으로 권한 취득 후, 반대로 공격자 방향으로 텔넷 서버 접속
    - 피해자 컴퓨터에 netcat툴 설치, 23포트를 열어둠
    - 공격자가 해당 IP로 23포트로 접속, 원격으로 파일 취득 및 삭제 가능
    - 스스로 나가는게 아니라 밖에서 나가라고 호출해서 나가게 되는 방식

### 외의 취약점들

- 민감한 데이터 노출
- 공격 방어 취약점
- CSRF 취약점
- 취약점이 있는 컴포넌트 사용
- 취약한 API
- 특수문자 필터링
- 서버 통제  작용
    - css 기반의 언어로 필터링하는건 로직 파악 시 쉽게 무력화됨
    - SSS로 필터링 로직을 수행해야 함
- 지속적인 세션 관리
    - 일관성있는 세션 인증 로직 표준화